{"ast":null,"code":"import \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/esnext.iterator.reduce.js\";\nimport Header from './Header.vue';\nimport { Chart, registerables } from 'chart.js';\nimport * as XLSX from 'xlsx';\nChart.register(...registerables);\nexport default {\n  name: 'ReportsPage',\n  components: {\n    Header\n  },\n  data() {\n    return {\n      reportData: [{\n        area: 'Area 1',\n        concern1: 5,\n        concern2: 10,\n        concern3: 3,\n        totalConcerns: 18,\n        resolvedConcerns: 12\n      }, {\n        area: 'Area 2',\n        concern1: 8,\n        concern2: 6,\n        concern3: 7,\n        totalConcerns: 21,\n        resolvedConcerns: 15\n      }\n      // Add more rows as needed\n      ]\n    };\n  },\n  mounted() {\n    this.renderCharts();\n  },\n  methods: {\n    renderCharts() {\n      // Graph: Concerns by Area\n      const concernsByAreaCtx = document.getElementById('concernsByArea').getContext('2d');\n      new Chart(concernsByAreaCtx, {\n        type: 'bar',\n        data: {\n          labels: this.reportData.map(row => row.area),\n          datasets: [{\n            label: 'Total Concerns',\n            data: this.reportData.map(row => row.totalConcerns),\n            backgroundColor: 'rgba(75, 192, 192, 0.6)',\n            borderColor: 'rgba(75, 192, 192, 1)',\n            borderWidth: 1\n          }]\n        },\n        options: {\n          responsive: true,\n          plugins: {\n            legend: {\n              position: 'top'\n            }\n          }\n        }\n      });\n\n      // Graph: Concerns Breakdown\n      const concernsBreakdownCtx = document.getElementById('concernsBreakdown').getContext('2d');\n      new Chart(concernsBreakdownCtx, {\n        type: 'pie',\n        data: {\n          labels: ['Concern 1', 'Concern 2', 'Concern 3'],\n          datasets: [{\n            data: [this.reportData.reduce((sum, row) => sum + row.concern1, 0), this.reportData.reduce((sum, row) => sum + row.concern2, 0), this.reportData.reduce((sum, row) => sum + row.concern3, 0)],\n            backgroundColor: ['rgba(75, 192, 192, 0.6)', 'rgba(54, 162, 235, 0.6)', 'rgba(255, 99, 132, 0.6)'],\n            borderColor: ['rgba(75, 192, 192, 1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 99, 132, 1)'],\n            borderWidth: 1\n          }]\n        },\n        options: {\n          responsive: true,\n          plugins: {\n            legend: {\n              position: 'top'\n            }\n          }\n        }\n      });\n    },\n    exportToExcel() {\n      // Convert data to a worksheet\n      const worksheet = XLSX.utils.json_to_sheet(this.reportData);\n\n      // Styling the header and adding borders\n      const headerStyle = {\n        font: {\n          bold: true\n        },\n        border: {\n          top: {\n            style: 'thin'\n          },\n          left: {\n            style: 'thin'\n          },\n          bottom: {\n            style: 'thin'\n          },\n          right: {\n            style: 'thin'\n          }\n        },\n        alignment: {\n          horizontal: 'center',\n          vertical: 'center'\n        }\n      };\n      const columnStyle = {\n        border: {\n          top: {\n            style: 'thin'\n          },\n          left: {\n            style: 'thin'\n          },\n          bottom: {\n            style: 'thin'\n          },\n          right: {\n            style: 'thin'\n          }\n        }\n      };\n\n      // Apply styles to header and columns\n      const range = XLSX.utils.decode_range(worksheet['!ref']); // Get the range\n      for (let col = range.s.c; col <= range.e.c; col++) {\n        const headerCell = worksheet[XLSX.utils.encode_cell({\n          r: 0,\n          c: col\n        })];\n        if (headerCell) {\n          headerCell.s = headerStyle;\n        }\n        for (let row = range.s.r + 1; row <= range.e.r; row++) {\n          const cell = worksheet[XLSX.utils.encode_cell({\n            r: row,\n            c: col\n          })];\n          if (cell) {\n            cell.s = columnStyle;\n          }\n        }\n      }\n\n      // Create a workbook and add the worksheet\n      const workbook = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(workbook, worksheet, 'Reports');\n\n      // Export the workbook\n      XLSX.writeFile(workbook, 'Reports.xlsx');\n    }\n  }\n};","map":{"version":3,"names":["Header","Chart","registerables","XLSX","register","name","components","data","reportData","area","concern1","concern2","concern3","totalConcerns","resolvedConcerns","mounted","renderCharts","methods","concernsByAreaCtx","document","getElementById","getContext","type","labels","map","row","datasets","label","backgroundColor","borderColor","borderWidth","options","responsive","plugins","legend","position","concernsBreakdownCtx","reduce","sum","exportToExcel","worksheet","utils","json_to_sheet","headerStyle","font","bold","border","top","style","left","bottom","right","alignment","horizontal","vertical","columnStyle","range","decode_range","col","s","c","e","headerCell","encode_cell","r","cell","workbook","book_new","book_append_sheet","writeFile"],"sources":["C:\\Users\\darle\\solid-waste-management-system\\src\\components\\ReportPage.vue"],"sourcesContent":["<template>\r\n  <div class=\"space-y-8\">\r\n    <Header />\r\n\r\n    <div class=\"mx-auto p-6 rounded-lg shadow-md\">\r\n      <div class=\"flex items-center justify-between\">\r\n        <h2 class=\"text-2xl font-semibold text-gray-800\">Reports</h2>\r\n        <button\r\n          @click=\"exportToExcel\"\r\n          class=\"py-2 px-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500\"\r\n        >\r\n          Export to Excel\r\n        </button>\r\n      </div>\r\n\r\n      <!-- Data Table -->\r\n      <div class=\"overflow-x-auto mt-6\">\r\n        <table class=\"min-w-full bg-white border border-gray-200\">\r\n          <thead>\r\n            <tr>\r\n              <th class=\"px-4 py-2 border-b border-gray-300 text-left text-sm font-semibold text-gray-700\">Area</th>\r\n              <th class=\"px-4 py-2 border-b border-gray-300 text-left text-sm font-semibold text-gray-700\">Total Number of Concern for Concern 1</th>\r\n              <th class=\"px-4 py-2 border-b border-gray-300 text-left text-sm font-semibold text-gray-700\">Total Number of Concern for Concern 2</th>\r\n              <th class=\"px-4 py-2 border-b border-gray-300 text-left text-sm font-semibold text-gray-700\">Total Number of Concern for Concern 3</th>\r\n              <th class=\"px-4 py-2 border-b border-gray-300 text-left text-sm font-semibold text-gray-700\">Total Number of Concerns</th>\r\n              <th class=\"px-4 py-2 border-b border-gray-300 text-left text-sm font-semibold text-gray-700\">Total Number of Resolved Concerns</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"(row, index) in reportData\" :key=\"index\" class=\"hover:bg-gray-100\">\r\n              <td class=\"px-4 py-2 border-b border-gray-300 text-sm text-gray-700\">{{ row.area }}</td>\r\n              <td class=\"px-4 py-2 border-b border-gray-300 text-sm text-gray-700\">{{ row.concern1 }}</td>\r\n              <td class=\"px-4 py-2 border-b border-gray-300 text-sm text-gray-700\">{{ row.concern2 }}</td>\r\n              <td class=\"px-4 py-2 border-b border-gray-300 text-sm text-gray-700\">{{ row.concern3 }}</td>\r\n              <td class=\"px-4 py-2 border-b border-gray-300 text-sm text-gray-700\">{{ row.totalConcerns }}</td>\r\n              <td class=\"px-4 py-2 border-b border-gray-300 text-sm text-gray-700\">{{ row.resolvedConcerns }}</td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      <!-- Graphs -->\r\n    <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-6\">\r\n        <div>\r\n            <h3 class=\"text-sm font-semibold text-gray-800 mb-2\">Concerns by Area</h3>\r\n            <canvas id=\"concernsByArea\" class=\"w-full max-w-xs h-32\"></canvas>\r\n        </div>\r\n        <div>\r\n            <h3 class=\"text-sm font-semibold text-gray-800 mb-2\">Concerns Breakdown</h3>\r\n            <canvas id=\"concernsBreakdown\" class=\"w-full max-w-xs h-10\"></canvas>\r\n        </div>\r\n    </div>\r\n\r\n\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Header from './Header.vue';\r\nimport { Chart, registerables } from 'chart.js';\r\nimport * as XLSX from 'xlsx';\r\n\r\nChart.register(...registerables);\r\n\r\nexport default {\r\n  name: 'ReportsPage',\r\n  components: {\r\n    Header,\r\n  },\r\n  data() {\r\n    return {\r\n      reportData: [\r\n        {\r\n          area: 'Area 1',\r\n          concern1: 5,\r\n          concern2: 10,\r\n          concern3: 3,\r\n          totalConcerns: 18,\r\n          resolvedConcerns: 12,\r\n        },\r\n        {\r\n          area: 'Area 2',\r\n          concern1: 8,\r\n          concern2: 6,\r\n          concern3: 7,\r\n          totalConcerns: 21,\r\n          resolvedConcerns: 15,\r\n        },\r\n        // Add more rows as needed\r\n      ],\r\n    };\r\n  },\r\n  mounted() {\r\n    this.renderCharts();\r\n  },\r\n  methods: {\r\n    renderCharts() {\r\n      // Graph: Concerns by Area\r\n      const concernsByAreaCtx = document.getElementById('concernsByArea').getContext('2d');\r\n      new Chart(concernsByAreaCtx, {\r\n        type: 'bar',\r\n        data: {\r\n          labels: this.reportData.map((row) => row.area),\r\n          datasets: [\r\n            {\r\n              label: 'Total Concerns',\r\n              data: this.reportData.map((row) => row.totalConcerns),\r\n              backgroundColor: 'rgba(75, 192, 192, 0.6)',\r\n              borderColor: 'rgba(75, 192, 192, 1)',\r\n              borderWidth: 1,\r\n            },\r\n          ],\r\n        },\r\n        options: {\r\n          responsive: true,\r\n          plugins: {\r\n            legend: {\r\n              position: 'top',\r\n            },\r\n          },\r\n        },\r\n      });\r\n\r\n      // Graph: Concerns Breakdown\r\n      const concernsBreakdownCtx = document.getElementById('concernsBreakdown').getContext('2d');\r\n      new Chart(concernsBreakdownCtx, {\r\n        type: 'pie',\r\n        data: {\r\n          labels: ['Concern 1', 'Concern 2', 'Concern 3'],\r\n          datasets: [\r\n            {\r\n              data: [\r\n                this.reportData.reduce((sum, row) => sum + row.concern1, 0),\r\n                this.reportData.reduce((sum, row) => sum + row.concern2, 0),\r\n                this.reportData.reduce((sum, row) => sum + row.concern3, 0),\r\n              ],\r\n              backgroundColor: ['rgba(75, 192, 192, 0.6)', 'rgba(54, 162, 235, 0.6)', 'rgba(255, 99, 132, 0.6)'],\r\n              borderColor: ['rgba(75, 192, 192, 1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 99, 132, 1)'],\r\n              borderWidth: 1,\r\n            },\r\n          ],\r\n        },\r\n        options: {\r\n          responsive: true,\r\n          plugins: {\r\n            legend: {\r\n              position: 'top',\r\n            },\r\n          },\r\n        },\r\n      });\r\n    },\r\n    exportToExcel() {\r\n      // Convert data to a worksheet\r\n      const worksheet = XLSX.utils.json_to_sheet(this.reportData);\r\n\r\n      // Styling the header and adding borders\r\n      const headerStyle = {\r\n        font: { bold: true },\r\n        border: {\r\n          top: { style: 'thin' },\r\n          left: { style: 'thin' },\r\n          bottom: { style: 'thin' },\r\n          right: { style: 'thin' },\r\n        },\r\n        alignment: { horizontal: 'center', vertical: 'center' },\r\n      };\r\n\r\n      const columnStyle = {\r\n        border: {\r\n          top: { style: 'thin' },\r\n          left: { style: 'thin' },\r\n          bottom: { style: 'thin' },\r\n          right: { style: 'thin' },\r\n        },\r\n      };\r\n\r\n      // Apply styles to header and columns\r\n      const range = XLSX.utils.decode_range(worksheet['!ref']); // Get the range\r\n      for (let col = range.s.c; col <= range.e.c; col++) {\r\n        const headerCell = worksheet[XLSX.utils.encode_cell({ r: 0, c: col })];\r\n        if (headerCell) {\r\n          headerCell.s = headerStyle;\r\n        }\r\n        for (let row = range.s.r + 1; row <= range.e.r; row++) {\r\n          const cell = worksheet[XLSX.utils.encode_cell({ r: row, c: col })];\r\n          if (cell) {\r\n            cell.s = columnStyle;\r\n          }\r\n        }\r\n      }\r\n\r\n      // Create a workbook and add the worksheet\r\n      const workbook = XLSX.utils.book_new();\r\n      XLSX.utils.book_append_sheet(workbook, worksheet, 'Reports');\r\n\r\n      // Export the workbook\r\n      XLSX.writeFile(workbook, 'Reports.xlsx');\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* Add any custom styles here */\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}