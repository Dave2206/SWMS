{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, withCtx as _withCtx, createVNode as _createVNode, Fragment as _Fragment, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"p-fluid\"\n};\nconst _hoisted_2 = {\n  class: \"p-field mb-4\"\n};\nconst _hoisted_3 = {\n  class: \"p-field mb-6\"\n};\nconst _hoisted_4 = {\n  class: \"p-field button-container\"\n};\nexport function render(_ctx, _cache) {\n  const _component_Button = _resolveComponent(\"Button\");\n  const _component_Menubar = _resolveComponent(\"Menubar\");\n  const _component_InputText = _resolveComponent(\"InputText\");\n  const _component_Dialog = _resolveComponent(\"Dialog\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createCommentVNode(\" Menu Bar \"), _createVNode(_component_Menubar, {\n    model: _ctx.filteredMenuItems\n  }, {\n    start: _withCtx(() => _cache[4] || (_cache[4] = [_createElementVNode(\"span\", {\n      class: \"text-xl font-bold text-gray-800\"\n    }, \"Solid Waste Management System\", -1 /* HOISTED */)])),\n    end: _withCtx(() => [_createCommentVNode(\" Login or Logout Button \"), !_ctx.isLoggedIn ? (_openBlock(), _createBlock(_component_Button, {\n      key: 0,\n      label: \"Login\",\n      icon: \"pi pi-user\",\n      class: \"p-button-outlined p-button-lg\",\n      onClick: _cache[0] || (_cache[0] = $event => _ctx.showLoginModal = true)\n    })) : _createCommentVNode(\"v-if\", true), _ctx.isLoggedIn ? (_openBlock(), _createBlock(_component_Button, {\n      key: 1,\n      label: \"Logout\",\n      icon: \"pi pi-sign-out\",\n      class: \"p-button-outlined p-button-lg\",\n      onClick: _ctx.logout\n    }, null, 8 /* PROPS */, [\"onClick\"])) : _createCommentVNode(\"v-if\", true)]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"model\"]), _createCommentVNode(\" Login Modal \"), _createVNode(_component_Dialog, {\n    header: \"Login\",\n    visible: _ctx.showLoginModal,\n    \"onUpdate:visible\": _cache[3] || (_cache[3] = $event => _ctx.showLoginModal = $event),\n    modal: \"\",\n    class: \"login-modal p-dialog-lg\",\n    style: {\n      \"width\": \"40vw\",\n      \"max-width\": \"500px\"\n    }\n  }, {\n    default: _withCtx(() => [_createCommentVNode(\" Logo \"), _cache[7] || (_cache[7] = _createElementVNode(\"div\", {\n      class: \"flex justify-center mb-6\"\n    }, [_createElementVNode(\"img\", {\n      src: \"assets/logo.png\",\n      alt: \"Logo\",\n      class: \"h-25 w-auto\"\n    })], -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_1, [_createCommentVNode(\" Email Field \"), _createElementVNode(\"div\", _hoisted_2, [_cache[5] || (_cache[5] = _createElementVNode(\"label\", {\n      for: \"email\",\n      class: \"block text-lg font-medium text-gray-700 mb-2\"\n    }, \"Email\", -1 /* HOISTED */)), _createVNode(_component_InputText, {\n      id: \"email\",\n      modelValue: _ctx.email,\n      \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => _ctx.email = $event),\n      placeholder: \"Enter your email\",\n      class: \"p-inputtext-lg w-full\"\n    }, null, 8 /* PROPS */, [\"modelValue\"])]), _createCommentVNode(\" Password Field \"), _createElementVNode(\"div\", _hoisted_3, [_cache[6] || (_cache[6] = _createElementVNode(\"label\", {\n      for: \"password\",\n      class: \"block text-lg font-medium text-gray-700 mb-2\"\n    }, \"Password\", -1 /* HOISTED */)), _createVNode(_component_InputText, {\n      type: \"password\",\n      id: \"password\",\n      modelValue: _ctx.password,\n      \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => _ctx.password = $event),\n      placeholder: \"Enter your password\",\n      class: \"p-inputtext-lg w-full\"\n    }, null, 8 /* PROPS */, [\"modelValue\"])]), _createCommentVNode(\" Login Button \"), _createElementVNode(\"div\", _hoisted_4, [_createVNode(_component_Button, {\n      label: \"Login\",\n      icon: \"pi pi-sign-in\",\n      class: \"p-button-lg p-button-success w-full login-btn\",\n      onClick: _ctx.login\n    }, null, 8 /* PROPS */, [\"onClick\"])])])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"visible\"])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["class","_createElementBlock","_Fragment","_createCommentVNode","_createVNode","_component_Menubar","model","_ctx","filteredMenuItems","start","_withCtx","_cache","_createElementVNode","end","isLoggedIn","_createBlock","_component_Button","key","label","icon","onClick","$event","showLoginModal","logout","_","_component_Dialog","header","visible","modal","style","default","src","alt","_hoisted_1","_hoisted_2","for","_component_InputText","id","modelValue","email","placeholder","_hoisted_3","type","password","_hoisted_4","login"],"sources":["C:\\Users\\darle\\solid-waste-management-system\\src\\components\\Header.vue"],"sourcesContent":["<template>\r\n    <!-- Menu Bar -->\r\n    <Menubar :model=\"filteredMenuItems\">\r\n      <template #start>\r\n        <span class=\"text-xl font-bold text-gray-800\">Solid Waste Management System</span>\r\n      </template>\r\n      <template #end>\r\n        <!-- Login or Logout Button -->\r\n        <Button \r\n          v-if=\"!isLoggedIn\" \r\n          label=\"Login\" \r\n          icon=\"pi pi-user\" \r\n          class=\"p-button-outlined p-button-lg\" \r\n          @click=\"showLoginModal = true\" \r\n        />\r\n        <Button \r\n          v-if=\"isLoggedIn\" \r\n          label=\"Logout\" \r\n          icon=\"pi pi-sign-out\" \r\n          class=\"p-button-outlined p-button-lg\" \r\n          @click=\"logout\" \r\n        />\r\n      </template>\r\n    </Menubar>\r\n\r\n    <!-- Login Modal -->\r\n    <Dialog \r\n      header=\"Login\" \r\n      v-model:visible=\"showLoginModal\" \r\n      modal \r\n      class=\"login-modal p-dialog-lg\" \r\n      style=\"width: 40vw; max-width: 500px;\"\r\n    >\r\n      <!-- Logo -->\r\n      <div class=\"flex justify-center mb-6\">\r\n        <img src=\"assets/logo.png\" alt=\"Logo\" class=\"h-25 w-auto\" />\r\n      </div>\r\n\r\n      <div class=\"p-fluid\">\r\n        <!-- Email Field -->\r\n        <div class=\"p-field mb-4\">\r\n          <label for=\"email\" class=\"block text-lg font-medium text-gray-700 mb-2\">Email</label>\r\n          <InputText \r\n            id=\"email\" \r\n            v-model=\"email\" \r\n            placeholder=\"Enter your email\" \r\n            class=\"p-inputtext-lg w-full\" \r\n          />\r\n        </div>\r\n\r\n        <!-- Password Field -->\r\n        <div class=\"p-field mb-6\">\r\n          <label for=\"password\" class=\"block text-lg font-medium text-gray-700 mb-2\">Password</label>\r\n          <InputText \r\n            type=\"password\" \r\n            id=\"password\" \r\n            v-model=\"password\" \r\n            placeholder=\"Enter your password\" \r\n            class=\"p-inputtext-lg w-full\" \r\n          />\r\n        </div>\r\n\r\n        <!-- Login Button -->\r\n        <div class=\"p-field button-container\">\r\n          <Button \r\n            label=\"Login\" \r\n            icon=\"pi pi-sign-in\" \r\n            class=\"p-button-lg p-button-success w-full login-btn\" \r\n            @click=\"login\" \r\n          />\r\n        </div>\r\n      </div>\r\n    </Dialog>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  name: \"HeaderVue\",\r\n  components: {\r\n  data() {\r\n    return {\r\n      showLoginModal: false, // Controls modal visibility\r\n      isLoggedIn: false, // Indicates if the user is logged in\r\n      email: \"\", // Email input\r\n      password: \"\", // Password input\r\n      abilities: [], // User's access levels\r\n    };\r\n  },\r\n  computed: {\r\n    filteredMenuItems() {\r\n      // Generate menu items dynamically based on abilities\r\n      return this.abilities.map((ability) => {\r\n        const routes = {\r\n          announcement: { label: \"Announcement\", icon: \"pi pi-megaphone\", page: \"AnnouncementPage\" },\r\n          messages: { label: \"Messages\", icon: \"pi pi-envelope\", page: \"MessagePage\" },\r\n          account_management: { label: \"Account Management\", icon: \"pi pi-users\", page: \"AccountManagementPage\" },\r\n          concern: { label: \"Concerns\", icon: \"pi pi-comments\", page: \"ConcernPage\" },\r\n          reports_and_analytics: { label: \"Reports and Analytics\", icon: \"pi pi-file\", page: \"ReportPage\" },\r\n        };\r\n\r\n        const route = routes[ability];\r\n        return route\r\n          ? {\r\n              label: route.label,\r\n              icon: route.icon,\r\n              command: () => this.navigateTo(route.page),\r\n            }\r\n          : null;\r\n      }).filter((item) => item !== null); // Filter out null entries\r\n    },\r\n  },\r\n  methods: {\r\n    async login() {\r\n      try {\r\n        const response = await axios.post(\"http://127.0.0.1:8000/api/login\", {\r\n          email: this.email,\r\n          password: this.password,\r\n        });\r\n\r\n        // Save token to localStorage\r\n        localStorage.setItem(\"auth_token\", response.data.access_token);\r\n\r\n        // Set token in axios headers\r\n        axios.defaults.headers.common[\"Authorization\"] = `Bearer ${localStorage.getItem(\"auth_token\")}`;\r\n\r\n        // Set login state\r\n        this.isLoggedIn = true;\r\n        this.showLoginModal = false;\r\n\r\n        // Fetch user abilities\r\n        await this.fetchAbilities();\r\n\r\n        // Redirect to dashboard\r\n        this.$router.push(\"/DashboardPage\");\r\n      } catch (error) {\r\n        console.error(\"Login failed:\", error);\r\n      }\r\n    },\r\n    logout() {\r\n      localStorage.removeItem(\"auth_token\");\r\n      this.isLoggedIn = false;\r\n      this.abilities = [];\r\n      this.$router.push(\"/\");\r\n    },\r\n    async fetchAbilities() {\r\n      try {\r\n        const response = await axios.get(\"http://127.0.0.1:8000/api/user/access-levels\");\r\n        this.abilities = response.data.access_levels || [];\r\n      } catch (error) {\r\n        console.error(\"Error fetching abilities:\", error);\r\n        this.abilities = [];\r\n      }\r\n    },\r\n    navigateTo(page) {\r\n      this.$router.push({ name: page });\r\n    },\r\n  },\r\n  async mounted() {\r\n    const token = localStorage.getItem(\"auth_token\");\r\n    if (token) {\r\n      axios.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\r\n      this.isLoggedIn = true;\r\n      await this.fetchAbilities();\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.header-container {\r\n  padding: 0 20px;\r\n  background: #f8f9fa;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}